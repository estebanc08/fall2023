What is LLMNR
    * Link-Local multicast name resolution
        - multicast and supports IPv6
        - used when DNS fails to provide a response for a host lookup for bare hostnames on the local subnet, such as printserver or wpad
        - can be disabled by disabling network discovery and disabling multicast name resolution with a group policy
        - Computer configuration -> administrative templates -> Network -> DNS client
        - normally only used by attackers, good to disable

LLMNR Failure modes
    * Mistyped host names will be answered by LLMNR host
    * If a request is made to a service at a mistyped host name eg \\prntserver vs \\printserver
    * The malicious host can then act as a main in the middle and capture credentials intended to be sent to actual host

What are WPAD and PAC
    * Web proxy auto discovery protocol (WPAD)
        - This protocol lets large installations propagate proxy information to their browsers from centralized file
    * Proxy Auto-Config File (PAC)
    * If WPAD requests get answered by malicious host, they can configure whatever proxy they want to configure

Broswer setup error
    * If the "automatically detect settings" box is checked in internet explorers internet options, IE will use WPAD to find the PAC file whenever default proxy lookup is requested

How does responder automate this
    * Responder responds to LLMNR request for WPAD host address
        - Avoid this by providing WPAD host entry in DNS
    * It delivers a PAC file that configures the browser to use a web proxy that responder provides
    * Responder identifies all URLs and captures all cookies that pass through the proxy
    * Responder can inject code into requested web pages

SMBRELAY attack with responder
    * responder will MITM SMB connections providing failure response to the client
    * Many corporate systems are set up to automatically use SMB to attempt to get admin access to hosts

Inveigh - A powershell alternative to responder
    * If you have control of a windows box within a network, you might want to use an LLMNR/mDNS/NBNS
